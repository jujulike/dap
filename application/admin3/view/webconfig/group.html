{extend name="public/base" /}

{block name="body"}
<script src="__PUBLIC__/admin/js/jquery-2.1.1.min.js"></script>
<script src="__PUBLIC__/home/layui/layui.js"></script>
<link href="__PUBLIC__/home/layui/css/layui.css" rel="stylesheet">
<div class="wrapper wrapper-content animated fadeInRight">
	<div class="row">
		<div class="col-lg-12">
			<div class="ibox-content">
				<form action="{:url('save')}" method="post" class="form-horizontal">
					{volist name="list" id="config"}
					<div class="form-group">
						<label class="col-sm-2 control-label">{$config.title}</label>
						<div class="col-sm-6">
						{switch name="config.type"}
						{case value="0"}
						<input type="text" class="form-control" name="config[{$config.name}]" value="{$config.value}">
						{/case}
						{case value="1"}
						<input type="text" class="form-control" name="config[{$config.name}]" value="{$config.value}">
						{/case}
						{case value="2"}
							<textarea class="form-control" name="config[{$config.name}]">{$config.value}</textarea>
						{/case}
						{case value="3"}
							<textarea class="form-control" name="config[{$config.name}]">{$config.value}</textarea>
						{/case}
						{case value="4"}
						<select name="config[{$config.name}]" class="form-control">
							{volist name=":parse_config_attr($config['extra'])" id="vo"}
								<option value="{$key}" {eq name="config.value" value="$key"}selected{/eq}>{$vo}</option>
							{/volist}
						</select>
						{/case}
						{case value="5"}
							<img id="showhead_{$config.name}" src="{$config.value|default='/static/admin/img/addbg2.png'}" style="max-height: 100px;max-width: 100px;">
							<input type="hidden" id="{$config.name}" class="form-control" name="config[{$config.name}]" value="{$config.value}">
							<!--<input type="file" name="config[{$config.name}]" id="file_head" class="hide">-->

							<script type="text/javascript">
                                layui.use('upload', function(){
                                    var $ = layui.jquery;
                                    var upload = layui.upload;

                                    upload.render({
                                        elem: '#showhead_{$config.name}',
                                        url: '{:url("upload/upload")}',
                                        size: 100000,
                                        exts: 'jpg|png|jpeg',
                                        multiple: true,
                                        before: function(obj) {
                                            layer.msg('图片上传中...', {
                                                icon: 16,
                                                shade: 0.01,
                                                time: 0
                                            })
                                        },
                                        done: function(res) {
                                            layer.close(layer.msg());//关闭上传提示窗口
                                            if(res.status == 0) {
                                                return layer.msg(res.message);
                                            }
                                            $("#showhead_{$config.name}").attr("src",  res.filepath) ;
                                            $("#{$config.name}").attr("value",  res.filepath) ;
                                        }
                                    });


                                });

							</script>
						{/case}
						{/switch}
						</div>
						<div class="col-sm-4"><p class="help-block">{$config.remark}</p></div>
					</div>
					{/volist}

					<div class="form-group">
						<div class="col-sm-9 col-sm-offset-2">
							{empty name="list"}
							<button type="submit" disabled class="btn btn-primary disabled" target-form="form-horizontal">确 定</button>
							{else/}
							<button type="submit" class="btn btn-primary ajax-post" target-form="form-horizontal">确 定</button>
							{/empty}
							<button class="btn btn-default" onclick="javascript:history.back(-1);return false;">返 回</button>
						</div>
					</div>
				</form>
			</div>

		</div>
	</div>
</div>
{/block}

{block name="script"}
<script>
	//导航高亮
	highlight_subnav('{:url('group')}');
</script>

{/block}
